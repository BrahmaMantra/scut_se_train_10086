# 定义agent名称
agent.sources = source1
agent.channels = channel1
agent.sinks = sink1_hdfs sink1_kafka

# 配置source
# 使用exec类型的source执行Java程序生成数据
agent.sources.source1.type = exec
agent.sources.source1.command = java -cp /root/generate_data-1.0-SNAPSHOT.jar core.GenerateData
agent.sources.source1.shell = /bin/bash
agent.sources.source1.restart = true
agent.sources.source1.restartThrottle = 10000

# 配置channel
agent.channels.channel1.type = memory
agent.channels.channel1.capacity = 1000
agent.channels.channel1.transactionCapacity = 100

# 配置HDFS sink
agent.sinks.sink1_hdfs.type = hdfs
agent.sinks.sink1_hdfs.hdfs.path = hdfs://bigdata01:9000/xdr/%Y%m%d
agent.sinks.sink1_hdfs.hdfs.filePrefix = xdr_
agent.sinks.sink1_hdfs.hdfs.fileType = DataStream
agent.sinks.sink1_hdfs.hdfs.writeFormat = Text
agent.sinks.sink1_hdfs.hdfs.batchSize = 1000
agent.sinks.sink1_hdfs.hdfs.rollInterval = 30
agent.sinks.sink1_hdfs.hdfs.rollSize = 0
agent.sinks.sink1_hdfs.hdfs.rollCount = 0
agent.sinks.sink1_hdfs.hdfs.useLocalTimeStamp = true

# 配置Kafka sink
agent.sinks.sink1_kafka.type = org.apache.flume.sink.kafka.KafkaSink
agent.sinks.sink1_kafka.kafka.bootstrap.servers = bigdata01:9092
agent.sinks.sink1_kafka.kafka.topic = xdr
agent.sinks.sink1_kafka.kafka.flumeBatchSize = 100
agent.sinks.sink1_kafka.kafka.producer.acks = 1
agent.sinks.sink1_kafka.kafka.producer.linger.ms = 1
agent.sinks.sink1_kafka.kafka.producer.batch.size = 16384

# 将source、channel和sink绑定在一起
agent.sources.source1.channels = channel1
agent.sinks.sink1_hdfs.channel = channel1
agent.sinks.sink1_kafka.channel = channel1
